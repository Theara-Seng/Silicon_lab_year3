C51 COMPILER V9.60.0.0   ULTRASONIC_SENSOR_MAIN                                            05/10/2021 19:00:08 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE ULTRASONIC_SENSOR_MAIN
OBJECT MODULE PLACED IN .\src\Ultrasonic_sensor_main.OBJ
COMPILER INVOKED BY: c:\SiliconLabs\SimplicityStudio\v5\developer\toolchains\keil_8051\9.60\BIN\C51.exe D:\year4-semeste
                    -r2\Silicon_lab_year3\Ultrasonic_sensor\src\Ultrasonic_sensor_main.c OMF2 SMALL DEBUG OBJECTEXTEND ROM(LARGE) WARNINGLEVE
                    -L(2) FLOATFUZZY(3) OPTIMIZE(0,SPEED) DEFINE(DEBUG=1) INTVECTOR(0X0000) INTPROMOTE INCDIR(D:\year4-semester2\Silicon_lab_
                    -year3\Ultrasonic_sensor\inc;C:/SiliconLabs/SimplicityStudio/v5/developer/sdks/8051/v4.2.0//Device/shared/si8051Base;C:/S
                    -iliconLabs/SimplicityStudio/v5/developer/sdks/8051/v4.2.0//Device/EFM8LB1/inc) PRINT(.\src\Ultrasonic_sensor_main.lst) C
                    -OND PAGEWIDTH(120) PAGELENGTH(65) OBJECT(.\src\Ultrasonic_sensor_main.OBJ)

line level    source

   1          //=========================================================
   2          // src/Ultrasonic_sensor_main.c: generated by Hardware Configurator
   3          //
   4          // This file will be updated when saving a document.
   5          // leave the sections inside the "$[...]" comment tags alone
   6          // or they will be overwritten!!
   7          //=========================================================
   8          
   9          //-----------------------------------------------------------------------------
  10          // Includes
  11          //-----------------------------------------------------------------------------
  12          #include <SI_EFM8LB1_Register_Enums.h>                  // SFR declarations
  13          #include "InitDevice.h"
  14          #include "serial.h"
  15          #include "delay.h"
  16          #include "pin.h"
  17          #include "HC-SR04.h"
  18          #include "stdint.h"
  19          #include "STDIO.H"
  20          // $[Generated Includes]
  21          // [Generated Includes]$
  22          sbit led = P1 ^ 3;
  23          uint16_t distance;
  24          char r;
  25          char string[6];
  26          char msg[60];
  27          //------------------------------------------------------                      -----------------------
  28          // SiLabs_Startup() Routine
  29          // ----------------------------------------------------------------------------
  30          // This function is called immediately after reset, before the initialization
  31          // code is run in SILABS_STARTUP.A51 (which runs before main() ). This is a
  32          // useful place to disable the watchdog timer, which is enable by default
  33          // and may trigger before main() in some instances.
  34          //-----------------------------------------------------------------------------
  35          void
  36          SiLabs_Startup (void)
  37          {
  38   1        // $[SiLabs Startup]
  39   1        // [SiLabs Startup]$
  40   1        WDTCN = 0xDE;
  41   1        WDTCN = 0xAD;
  42   1      }
  43          
  44          //-----------------------------------------------------------------------------
  45          // main() Routine
  46          // ----------------------------------------------------------------------------
  47          int
  48          main (void)
  49          {
  50   1        // Call hardware initialization routine
  51   1        //enter_DefaultMode_from_RESET ();
C51 COMPILER V9.60.0.0   ULTRASONIC_SENSOR_MAIN                                            05/10/2021 19:00:08 PAGE 2   

  52   1        CLKSEL = CLKSEL_CLKDIV__SYSCLK_DIV_1 | CLKSEL_CLKSL__HFOSC0;
  53   1        CKCON0 |=CKCON0_T0M__PRESCALE | CKCON0_SCA__SYSCLK_DIV_48|CKCON0_T1M__SYSCLK;
  54   1        XBR2 |= XBR2_XBARE__ENABLED;
  55   1        XBR0 |= XBR0_URT0E__ENABLED;
  56   1        P0MDOUT |= P0MDOUT_B4__PUSH_PULL |P0MDOUT_B5__PUSH_PULL;
  57   1        Uart_timer ();
  58   1        P1MDOUT |= P1MDOUT_B3__PUSH_PULL;
  59   1      //  P0MDOUT = P0MDOUT_B4__PUSH_PULL;
  60   1       // P0MDOUT |= P0MDOUT_B0__PUSH_PULL;
  61   1        P0MDOUT |= P0MDOUT_B1__PUSH_PULL;
  62   1        P0MDOUT |= P0MDOUT_B0__PUSH_PULL;
  63   1        led=0;
  64   1        while (1)
  65   1          {
  66   2      
  67   2      
  68   2            if (hc_sr04_get_distance (&distance) == HC_SR04_SUCCESS)
  69   2              {
  70   3               sprintf (msg, "the distance is %d\n", distance);
  71   3                put_string (msg);
  72   3              }
  73   2            else
  74   2             {
  75   3                put_string ("out of range");
  76   3              }
  77   2              delay_ms (1000);
  78   2      
  79   2      //    r=receive_char();
  80   2      //    if (r=='h'){
  81   2      //        led=0;
  82   2      //       put_char(r);
  83   2      //    }
  84   2      //    else if (r=='i'){
  85   2      //        led=1;
  86   2      //        put_char(r);
  87   2      //    }
  88   2      
  89   2      // $[Generated Run-time code]
  90   2      // [Generated Run-time code]$
  91   2             //   delay_ms (400);
  92   2          }
  93   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    124    ----
   CONSTANT SIZE    =     33    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     69    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
